%! Author = hildo
%! Date = 2024/4/17

% Preamble
\documentclass{ctexart}

% Packages
\usepackage{amsmath}
\usepackage{float}
\usepackage{tikz}

\title{平面极坐标、柱坐标、球坐标下的加速度表达式}
\author{申治洺}
\date{2022年10月22日\footnote{最初发表时间。本文最初发表于知乎，可参见https://zhuanlan.zhihu.com/p/574555169}}

% Document
\begin{document}

    \maketitle  % 生成标题
    
    \section{导言}\label{sec:1}

    下文提到的速度表达式和加速度表达式分别指用坐标对时间的一阶和二阶导数及坐标相应的基底表示速度和加速度矢量的公式。
    因为直角坐标系的基底不随坐标变化而变化，直角坐标系下速度和加速度的表达式非常简单。但本文所探讨的这三种坐标系不具有该性质，
    于是推导三种坐标系下速度和加速度的表达式不那么容易。

    下面是三种坐标系的图。不同书上用来表示坐标的字母不同，这里统一以图上为准。

    对平面极坐标系，
    \begin{equation*}
        \mathrm{d}\vec{l} = \mathrm{d}r\cdot\hat{r} + r\mathrm{d}\theta\cdot\hat{\theta}
        % 微分符号为直立的小写字母d，要使用\mathrm{text}
    \end{equation*}
    
    对柱坐标系，
    \begin{equation*}
        \mathrm{d}\vec{l} = \mathrm{d}r\cdot\hat{r} + r\mathrm{d}\theta\cdot\hat{\theta} +
        \mathrm{d}z\cdot\hat{k}
    \end{equation*}
    
    对球坐标系，
    \begin{equation*}
        \mathrm{d}\vec{l} = \mathrm{d}r\cdot\hat{r} + r\mathrm{d}\theta\cdot\hat{\theta} +
        r\sin\theta\mathrm{d}\varphi\cdot\hat{\varphi}
    \end{equation*}

    由此很容易得出三种坐标系下的速度表达式，
    \begin{gather*}
        \vec{v} = \frac{\mathrm{d}\vec{r}}{\mathrm{d}t} = \frac{\mathrm{d}\vec{l}}{\mathrm{d}t} =
        \dot{r}\hat{r} + r\dot{\theta}\hat{\theta} \\
        \vec{v} = \frac{\mathrm{d}\vec{r}}{\mathrm{d}t} = \frac{\mathrm{d}\vec{l}}{\mathrm{d}t} =
        \dot{r}\hat{r} + r\dot{\theta}\hat{\theta} + \dot{z}\hat{k} \\
        \vec{v} = \frac{\mathrm{d}\vec{r}}{\mathrm{d}t} = \frac{\mathrm{d}\vec{l}}{\mathrm{d}t} =
        \dot{r}\hat{r} + r\dot{\theta}\hat{\theta} + r\sin\theta\dot{\varphi}\hat{\varphi}
    \end{gather*}
    % begin{equation*} ... end{equation*} 环境只适用于单行的居中无编号公式

    接下来准备求加速度，先求出各个基底变化率的表达式（一会儿会用）。
    因为对平面极坐标系的加速度表达式稍加修改即可得柱坐标系的加速度表达式，所以下面不详细介绍柱坐标系的加速度表达式的求法。

    对平面极坐标系，画画图就可得出径向单位向量的增量平行于角向单位向量，角向单位向量的增量平行于径向单位向量，
    两者的大小也很容易确定。

    \begin{gather*}
        \dot{\hat{r}} = \dot{\theta}\hat{\theta} \\
        \dot{\hat{\theta}} = -\dot{\theta}\hat{r}
    \end{gather*}

    除了这样做，也可以借助直角坐标系，
    \begin{gather*}
        \hat{r} = (\cos\theta,\sin\theta) \\
        \dot{\hat{r}} = (-\sin\theta\dot{\theta},\cos\theta\dot{\theta}) \\
        \hat{\theta} = (-\sin\theta,\cos\theta) \\
        \dot{\hat{\theta}} = (-\cos\theta\dot{\theta},-\sin\theta\dot{\theta})
    \end{gather*}

    立得，
    \begin{gather*}
        \dot{\hat{r}} = \dot{\theta}\hat{\theta} \\
        \dot{\hat{\theta}} = -\dot{\theta}\hat{r}
    \end{gather*}

    对球坐标系，不太容易用画图求各个基底变化率的表达式，一般借助直角坐标系，
    \begin{gather*}
        \hat{r} = (\sin\theta\cos\varphi,\sin\theta\sin\varphi,\cos\theta) \\
        \hat{\theta} = (\cos\theta\cos\varphi,\cos\theta\sin\varphi,-\sin\theta) \\
        \hat{\varphi} = (-\sin\varphi,\cos\varphi,0)
    \end{gather*}

    \begin{gather*}
        \dot{\hat{r}} = (\cos\theta\cos\varphi\dot{\theta}-\sin\theta\sin\varphi\dot{\varphi},
        \cos\theta\sin\varphi\dot{\theta}+\sin\theta\cos\varphi\dot{\varphi},
        -\sin\theta\dot{\theta}) \\
        \dot{\hat{\theta}} = (-\sin\theta\cos\varphi\dot{\theta}-\cos\theta\sin\varphi\dot{\varphi},
        -\sin\theta\sin\varphi\dot{\theta}+\cos\theta\cos\varphi\dot{\varphi}
        -\cos\theta\dot{\theta},) \\
        \dot{\hat{\varphi}} = (-\cos\varphi\dot{\varphi},-\sin\varphi\dot{\varphi},0)
    \end{gather*}

    \begin{gather*}
        \dot{\hat{r}} = \sin\theta\dot{\varphi}\hat{\varphi}+\dot{\theta}\hat{\theta} \\
        \dot{\hat{\theta}} = \cos\theta\dot{\varphi}\hat{\varphi}-\dot{\theta}\hat{r} \\
        \dot{\hat{\varphi}} = (-\sin\theta\hat{r}-\cos\theta\hat{\theta})\dot{\varphi}
    \end{gather*}

    接下来正式求加速度。

    \section{方法一、直接求导}\label{sec:2}
    % 中文标题带空格，要使用~

    对平面极坐标系，
    \begin{align*}
        \vec{a} &= \ddot{r}\hat{r}+\dot{r}\dot{\hat{r}}+(\dot{r}\dot{\theta}+r\ddot{\theta})\hat{\theta}
        +r\dot{\theta}\dot{\hat{\theta}} \\
        &= \ddot{r}\hat{r}+\dot{r}\dot{\theta}\hat{\theta}+(\dot{r}\dot{\theta}+r\ddot{\theta})
        \hat{\theta}+r\dot{\theta}(-\dot{\theta}\hat{r}) \\
        &= (\ddot{r}-r\dot{\theta}^2)\hat{r}+(r\ddot{\theta}+2\dot{r}\dot{\theta})\hat{\theta}
    \end{align*}

    应当指出角向分量中的第二项来自科氏加速度，这一点在法二中可以看出。

    对球坐标系，同理得,
    \begin{equation*}
        \vec{a} = (\ddot{r}-r\dot{\theta}^2-r\sin^2\theta\dot{\varphi}^2)\hat{r}+
        (r\ddot{\theta}+2\dot{r}\dot{\theta}-r\sin\theta\cos\theta\dot{\varphi^2})\hat{\theta}+
        (r\sin\theta\ddot{\varphi}+2\dot{r}\sin\theta\dot{\varphi}+
        2r\cos\theta\dot{\theta}\dot{\varphi})\hat{\varphi}
    \end{equation*}

    \section{方法二、借助转动系的加速度变换公式}\label{sec:3}

    用$\vec{a_a}$、$\vec{a_e}$、$\vec{a_r}$、$\vec{a_c}$分别表示绝对加速度、牵连加速度、相对加速度、科氏加速度，
    用$\vec{\omega}$和$\vec{\beta}$分别表示转动系的角速度和角加速度。

    \begin{gather*}
        \vec{a_a} = \frac{\mathrm{d}^2\vec{r_a}}{\mathrm{d}t^2} \\
        \vec{a_e} = \frac{\mathrm{d}^2\vec{r_e}}{\mathrm{d}t^2}+
        \vec{\omega}\times(\vec{\omega}\times\vec{r_r})+
        \vec{\beta}\times\vec{r_r} \\
        \vec{a_r} = (\frac{\mathrm{d}^2\vec{r_r}}{\mathrm{d}t^2})_{\text{动系}} \\
        \vec{a_c} = 2\vec{\omega}\times(\frac{\mathrm{d}\vec{r}}{\mathrm{d}t})_{\text{动系}}
    \end{gather*}

    选取一个以坐标原点为定点，跟随径矢$\vec{r}$的方向不断转动的转动系。
    在这个参考系中$\vec{r}$指向的质点只有径向方向的速度和加速度。

    对平面极坐标系，显然有,
    \begin{gather*}
        \vec{\omega} = \dot{\theta}(\hat{r}\times\hat{\theta}) \\
        \vec{\beta} = \ddot{\theta}(\hat{r}\times\hat{\theta})
    \end{gather*}

    使用加速度变换公式，得
    \begin{gather}
        \vec{v_r} = \dot{r}\hat{r} \label{eq:1} \\
        \vec{a_r} = \ddot{r}\hat{r} \label{eq:2} \\
        \vec{a_e} = \vec{\beta}\times\vec{r}+\vec{\omega}\times(\vec{\omega}\times\vec{r})
        \label{eq:3} \\
        \vec{a_c} = 2\vec{\omega}\times\dot{r}\hat{r} \label{eq:4}
    \end{gather}

    代入$\vec{\omega}$和$\vec{\beta}$的表达式，并将加速度各组成部分合并起来，得
    \begin{equation*}
        \vec{a} = (\ddot{r}-r\dot{\theta}^2)\hat{r}+(r\ddot{r}+2\dot{r}\dot{\theta})\hat{\theta}
    \end{equation*}

    对球坐标系，$\vec{\omega}$和$\vec{\beta}$的表达式比较复杂，
    而且求$\vec{\beta}$时还要利用球坐标系各基底变化率的表达式。方向上$\vec{\omega}$与$\hat{r}\times\vec{v}$一致，
    大小上$|\vec{\omega}| = \lim_{\Delta t \to 0}|\frac{\Delta\alpha}{\Delta t}|$，而
    \begin{equation*}
        |\hat{r}\times\vec{v}| = |\hat{r}\times\vec{v}_{\text{$\perp\hat{r}$}}| =
        |\vec{v}_{\text{$\perp\hat{r}$}}| =
        |r\cdot\lim_{\Delta t \to 0}\frac{\Delta\alpha}{\Delta t}| =
        |\vec{r}|\lim_{\Delta t \to 0}|\frac{\Delta\alpha}{\Delta t}|
    \end{equation*}

    于是有,
    \begin{gather*}
        \vec{\omega} = \frac{\hat{r}\times\vec{v}}{|\vec{r}|} \\
        \vec{\beta} = \frac{\mathrm{d}\vec{\omega}}{\mathrm{d}t}
    \end{gather*}

    将已知的各表达式代入，得
    \begin{gather*}
        \vec{\omega} = -\sin\theta\dot{\varphi}\hat{\theta}+\dot{\theta}\hat{\varphi} \\
        \vec{\beta} = (-2\cos\theta\dot{\theta}\dot{\varphi}-\sin\theta\ddot{\varphi})\hat{\theta}+
        (\ddot{\theta}-\sin\cos\dot{\varphi}^2)\hat{\varphi}
    \end{gather*}

    再利用公式\eqref{eq:1}\eqref{eq:2}\eqref{eq:3}\eqref{eq:4}，得
    \begin{equation*}
        \vec{a} = (\ddot{r}-r\dot{\theta}^2-r\sin^2\theta\dot{\varphi}^2)\hat{r}+
        (r\ddot{\theta}+2\dot{r}\dot{\theta}-r\sin\theta\cos\theta\dot{\varphi^2})\hat{\theta}+
        (r\sin\theta\ddot{\varphi}+2\dot{r}\sin\theta\dot{\varphi}+
        2r\cos\theta\dot{\theta}\dot{\varphi})\hat{\varphi}
    \end{equation*}

    \section{方法三、借助广义力形式的拉格朗日方程}\label{sec:4}

    广义力形式的拉格朗日方程
    \begin{gather*}
        Q_{\alpha} = \sum_{i = 1}^{n} \vec{F_i}\cdot\frac{\partial\vec{r_i}}{\partial q_{\alpha}} \\
        \frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\dot{q_{\alpha}}} -
        \frac{\partial T}{q_{\alpha}} = Q_{\alpha}
    \end{gather*}

    \section{总结}\label{sec:5}

    \begin{itemize}
        \item 平面极坐标系
            \begin{equation*}
                \vec{a} = (\ddot{r}-r\dot{\theta}^2)\hat{r}+
                (r\ddot{\theta}+2\dot{r}\dot{\theta})\hat{\theta}
            \end{equation*}
        \item 柱坐标系
            \begin{equation*}
                \vec{a} = (\ddot{r}-r\dot{\theta}^2)\hat{r}+
                (r\ddot{\theta}+2\dot{r}\dot{\theta})\hat{\theta}+
                \dot{z}\hat{k}
            \end{equation*}
        \item 球坐标系
            \begin{equation*}
                \vec{a} = (\ddot{r}-r\dot{\theta}^2-r\sin^2\theta\dot{\varphi}^2)\hat{r}+
                (r\ddot{\theta}+2\dot{r}\dot{\theta}-r\sin\theta\cos\theta\dot{\varphi^2})\hat{\theta}+
                (r\sin\theta\ddot{\varphi}+2\dot{r}\sin\theta\dot{\varphi}+
                2r\cos\theta\dot{\theta}\dot{\varphi})\hat{\varphi}
            \end{equation*}
    \end{itemize}

    上面给出的三种方法中，最容易想到的是第一种方法，不过需要求出各个基底变化率的表达式，尤其是球坐标，计算量不小；
    第二种方法需要大家学过理论力学中点的合成运动相关内容，求平面极坐标系的加速度表达式非常简便，
    但是求球坐标系的加速度表达式很复杂，这时不建议使用；第三种方法需要大家学过分析力学的部分内容，但是它是三种方法中最简便的一种。

\end{document}